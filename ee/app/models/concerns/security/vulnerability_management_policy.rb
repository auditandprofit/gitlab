# frozen_string_literal: true

module Security
  module VulnerabilityManagementPolicy
    POLICY_TYPE_NAME = 'Vulnerability management policy'

    def active_vulnerability_management_policies
      policy_limit = limit_service.vulnerability_management_policies_per_configuration_limit
      vulnerability_management_policy.select { |config| config[:enabled] }.first(policy_limit)
    end

    def vulnerability_management_policy
      policy_by_type(:vulnerability_management_policy)
    end
  end
end
